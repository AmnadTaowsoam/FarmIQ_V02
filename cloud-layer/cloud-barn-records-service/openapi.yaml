openapi: 3.0.0
info:
  title: Barn Records Service API
  version: 1.0.0
  description: FarmIQ Cloud Barn Records Service - Barn health, welfare, housing, and genetic records
servers:
  - url: http://localhost:3000
    description: Local development server
paths:
  /api/health:
    get:
      summary: Health check
      responses:
        '200':
          description: Service is healthy
  /api/ready:
    get:
      summary: Readiness check
      responses:
        '200':
          description: Service is ready
        '503':
          description: Service is not ready
  /api/v1/barn-records/morbidity:
    post:
      summary: Create morbidity event
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
                - animalCount
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                diseaseCode:
                  type: string
                severity:
                  type: string
                  enum: [low, medium, high]
                animalCount:
                  type: integer
                  minimum: 0
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/mortality:
    post:
      summary: Create mortality event
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
                - animalCount
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                causeCode:
                  type: string
                animalCount:
                  type: integer
                  minimum: 0
                disposalMethod:
                  type: string
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/vaccines:
    post:
      summary: Create vaccine event
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
                - vaccineName
                - animalCount
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                vaccineName:
                  type: string
                doseMl:
                  type: number
                  minimum: 0
                route:
                  type: string
                administeredBy:
                  type: string
                animalCount:
                  type: integer
                  minimum: 0
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/treatments:
    post:
      summary: Create treatment event
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
                - treatmentName
                - animalCount
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                treatmentName:
                  type: string
                doseMl:
                  type: number
                  minimum: 0
                route:
                  type: string
                durationDays:
                  type: integer
                  minimum: 0
                animalCount:
                  type: integer
                  minimum: 0
                withdrawalDays:
                  type: integer
                  minimum: 0
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/daily-counts:
    post:
      summary: Create daily count
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - recordDate
                - animalCount
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                recordDate:
                  type: string
                  format: date
                animalCount:
                  type: integer
                  minimum: 0
                averageWeightKg:
                  type: number
                  minimum: 0
                mortalityCount:
                  type: integer
                  minimum: 0
                cullCount:
                  type: integer
                  minimum: 0
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
    get:
      summary: List daily counts
      parameters:
        - in: query
          name: tenantId
          required: true
          schema:
            type: string
            format: uuid
        - in: query
          name: farmId
          schema:
            type: string
            format: uuid
        - in: query
          name: barnId
          schema:
            type: string
            format: uuid
        - in: query
          name: batchId
          schema:
            type: string
            format: uuid
        - in: query
          name: start
          schema:
            type: string
            format: date
        - in: query
          name: end
          schema:
            type: string
            format: date
        - in: query
          name: cursor
          schema:
            type: string
        - in: query
          name: limit
          schema:
            type: integer
            default: 25
      responses:
        '200':
          description: Success
        '400':
          description: Validation error
  /api/v1/barn-records/welfare-checks:
    post:
      summary: Create welfare check
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                gaitScore:
                  type: integer
                  minimum: 0
                  maximum: 5
                lesionScore:
                  type: integer
                  minimum: 0
                  maximum: 5
                behaviorScore:
                  type: integer
                  minimum: 0
                  maximum: 5
                observer:
                  type: string
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/housing-conditions:
    post:
      summary: Create housing condition
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - farmId
                - barnId
                - occurredAt
              properties:
                tenantId:
                  type: string
                  format: uuid
                farmId:
                  type: string
                  format: uuid
                barnId:
                  type: string
                  format: uuid
                occurredAt:
                  type: string
                  format: date-time
                stockingDensity:
                  type: number
                  minimum: 0
                beddingType:
                  type: string
                ventilationMode:
                  type: string
                temperatureC:
                  type: number
                humidityPct:
                  type: number
                  minimum: 0
                  maximum: 100
                ammoniaPpm:
                  type: number
                  minimum: 0
                notes:
                  type: string
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict
  /api/v1/barn-records/genetics:
    post:
      summary: Create genetic profile
      parameters:
        - in: header
          name: Idempotency-Key
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - batchId
              properties:
                tenantId:
                  type: string
                  format: uuid
                batchId:
                  type: string
                  format: uuid
                strain:
                  type: string
                breedLine:
                  type: string
                supplier:
                  type: string
                hatchDate:
                  type: string
                  format: date
                externalRef:
                  type: string
      responses:
        '201':
          description: Created
        '400':
          description: Validation error
        '409':
          description: Conflict

