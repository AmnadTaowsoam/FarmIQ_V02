# Mosquitto Configuration for FarmIQ Edge Layer - PRODUCTION
#
# SECURITY NOTICE: This configuration enables TLS and mTLS.
# Certificates must be present in /mosquitto/config/certs/

# ==================================================
# Production Listeners
# ==================================================

# Port 8883 (TLS/SSL MQTT) - Main Production Port
listener 8883
protocol mqtt

# TLS Configuration
cafile /mosquitto/config/certs/ca.crt
certfile /mosquitto/config/certs/server.crt
keyfile /mosquitto/config/certs/server.key

# mTLS (Mutual TLS) - Require client certificates
require_certificate true
use_identity_as_username true

# ==================================================
# Persistence & Logging
# ==================================================
persistence true
persistence_location /mosquitto/data/
log_dest stdout
# log_type all # Uncomment for verbose debugging

# ==================================================
# Security Defaults
# ==================================================
allow_anonymous false

# ==================================================
# Development Fallback (Optional - Comment out in pure prod)
# ==================================================
# listener 1883
# allow_anonymous true
# bind_address 127.0.0.1 # Bind to localhost only if enabled
